mode: testnet # backtest | testnet | live
symbol: BTCUSDT
instance_id: bot1 # used in state path and clientOrderId prefix

grid:
  contract_mode: dual # dual | long | short
  stop_price: "0" # stop strategy when market price > stop_price (0 means disabled)
  ratio: "1.012" # buy-side geometric spacing ratio, must be > 1
  ratio_step: "0.002" # buy-ratio defense increment on each down-shift trigger (0 disables increment, omit to use default 0.002)
  ratio_qty_multiple: "1.2" # during down-shift extension, new buy order qty = qty * ratio_qty_multiple
  sell_ratio: "1.012" # sell-side geometric spacing ratio, must be > 1
  levels: 20 # initial grid levels per side (dual) / per-direction side (long-short)
  shift_levels: 10 # up/down shift step size
  mode: geometric # only geometric is supported
  qty: "0.001" # order qty before rule rounding
  min_qty_multiple: 1 # final qty floor = min_qty * min_qty_multiple

state:
  dir: "state_futures" # state_futures/{mode}/{symbol}/{instance_id}, includes state/open_orders/runtime_status
  lock_takeover: true # try taking over stale .instance.lock when previous process crashed
  lock_stale_sec: 600 # stale threshold for lock file age fallback checks

circuit_breaker:
  enabled: true
  max_place_failures: 5
  max_cancel_failures: 5
  max_reconnect_failures: 10
  reconnect_cooldown_sec: 30 # cooldown before reconnect probe in half-open state
  reconnect_probe_passes: 1 # successful reconnect probes required to close breaker

observability:
  telegram:
    enabled: false
    bot_token: "YOUR_TELEGRAM_BOT_TOKEN"
    chat_id: "YOUR_TELEGRAM_CHAT_ID"
    api_base_url: "https://api.telegram.org"
    timeout_sec: 10
  runtime:
    heartbeat_sec: 60 # 0 disables runtime status heartbeat file updates
    reconcile_interval_sec: 60 # 0 disables periodic reconcile (not recommended for live)
    alert_drop_report_sec: 60 # 0 disables periodic alert_queue_dropped summary logs

backtest:
  # supports single jsonl file or a directory with date-partitioned files like 2026-02-01.jsonl
  data_path: /path/to/data_or_dir
  initial_base: "0"
  initial_quote: "1000"
  fees:
    maker_rate: "0.001"
    taker_rate: "0.001"
  rules:
    min_qty: "0"
    min_notional: "0"
    price_tick: "0"
    qty_step: "0"

exchange:
  api_key: "YOUR_TESTNET_API_KEY"
  api_secret: "YOUR_TESTNET_API_SECRET"
  # USDâ“ˆ-M Futures endpoints
  rest_base_url: "https://testnet.binancefuture.com"
  ws_base_url: "wss://stream.binancefuture.com"
  position_mode: hedge # hedge | oneway (dual mode requires hedge)
  margin_type: cross # cross | isolated
  leverage: 3 # 1..125
  recv_window_ms: 5000
  http_timeout_sec: 15
  user_stream_keepalive_sec: 30 # user-stream ws ping/read heartbeat interval
  order_ws_keepalive_sec: 30 # order channel keepalive interval
