mode: testnet # backtest | testnet | live
symbol: BTCUSDT
instance_id: bot1 # used in state path and clientOrderId prefix

grid:
  stop_price: "0" # stop strategy when market price > stop_price (0 means disabled)
  ratio: "1.012" # buy-side geometric spacing ratio, must be > 1
  sell_ratio: "1.012" # sell-side geometric spacing ratio, must be > 1
  levels: 20 # active buy levels below anchor
  shift_levels: 10 # active sell levels above anchor; also used as shift window size
  mode: geometric # only geometric is supported
  qty: "0.001" # order qty before rule rounding
  qty_scale: "1" # global risk scaler (0,1], applied to qty before min_qty_multiple
  min_qty_multiple: 1 # final qty floor = min_qty * min_qty_multiple
  regime:
    enabled: false
    window: 30
    enter_score: "1.8"
    exit_score: "1.2"
    enter_confirm: 3
    exit_confirm: 5
    min_dwell_sec: 600
    trend_up_buy_spacing_mult: "0.7" # trend_up: buy spacing becomes tighter
    trend_down_buy_spacing_mult: "1.6" # trend_down: buy spacing becomes wider
    trend_down_sell_spacing_mult: "0.7" # trend_down: sell spacing becomes tighter
    trend_up_sell_qty_factor: "0.5" # trend_up: new sell qty scales down when qty > min_qty

state:
  dir: "state" # state/{mode}/{symbol}/{instance_id}, includes state/open_orders/runtime_status
  lock_takeover: true # try taking over stale .instance.lock when previous process crashed
  lock_stale_sec: 600 # stale threshold for lock file age fallback checks

circuit_breaker:
  enabled: true
  max_place_failures: 5
  max_cancel_failures: 5
  max_reconnect_failures: 10
  reconnect_cooldown_sec: 30 # cooldown before reconnect probe in half-open state
  reconnect_probe_passes: 1 # successful reconnect probes required to close breaker

observability:
  telegram:
    enabled: false
    bot_token: "YOUR_TELEGRAM_BOT_TOKEN"
    chat_id: "YOUR_TELEGRAM_CHAT_ID"
    api_base_url: "https://api.telegram.org"
    timeout_sec: 10
  runtime:
    heartbeat_sec: 60 # 0 disables runtime status heartbeat file updates
    reconcile_interval_sec: 60 # 0 disables periodic reconcile (not recommended for live)
    alert_drop_report_sec: 60 # 0 disables periodic alert_queue_dropped summary logs

backtest:
  # supports single jsonl file or a directory with date-partitioned files like 2026-02-01.jsonl
  data_path: /path/to/data_or_dir
  initial_base: "0"
  initial_quote: "1000"
  fees:
    maker_rate: "0.001"
    taker_rate: "0.001"
  rules:
    min_qty: "0"
    min_notional: "0"
    price_tick: "0"
    qty_step: "0"

exchange:
  api_key: "YOUR_TESTNET_API_KEY"
  api_secret: "YOUR_TESTNET_API_SECRET"
  # Current grid-trading repo uses SPOT endpoints.
  # If you run a futures branch, switch these to fapi endpoints.
  rest_base_url: "https://testnet.binance.vision"
  ws_base_url: "wss://ws-api.testnet.binance.vision/ws-api/v3"
  user_stream_auth: signature # signature | session
  ws_ed25519_private_key_path: "" # required only when user_stream_auth=session
  recv_window_ms: 5000
  http_timeout_sec: 15
  user_stream_keepalive_sec: 30 # user-stream ws ping/read heartbeat interval
  order_ws_keepalive_sec: 30 # ws-api ping interval
